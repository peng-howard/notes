---
layout: post
title: (转载) 应用VAR模型时的15个注意点(笔记)
categories: [计量经济学]
tags: [time series, VAR, VEC, 平稳, 单位根, 协整, ADF检验, Johansen协整检验]
---

原文地址：<http://blog.sina.com.cn/s/blog_3f8600030100obc3.html>

向量自回归(VAR, Vector Auto regression)常用于预测相互联系的时间序列系统以及分析随机扰动对变量系统的动态影响。VAR方法通过把系统中每一个内生变量,作为系统中所有内生变量的滞后值的函数来构造模型，从而回避了结构化模型的要求。Engle和Granger(1987a)指出两个或多个非平稳时间序列的线性组合可能是平稳的。假如这样一种平稳的或的线性组合存在，这些非平稳(有单位根)时间序列之间被认为是具有协整关系的。这种平稳的线性组合被称为协整方程且可被解释为变量之间的长期均衡关系。

VAR模型对于相互联系的时间序列变量系统是有效的预测模型，同时，向量自回归模型也被频繁地用于分析不同类型的随机误差项对系统变量的动态影响。如果变量之间仅存在滞后影响(原文为**不仅**)，而不存在同期影响关系，则适合建立VAR模型，因为VAR模型实际上是把当期关系隐含到了随机扰动项之中。

注意点：

1. 单位根检验是序列的平稳性检验，如果不检验序列的平稳性直接OLS容易导致伪回归。
2. 当检验的数据是平稳的(即不存在单位根)，要想进一步考察变量的因果联系，可以采用格兰杰因果检验，但要做**格兰杰检验的前提是数据必须是平稳的**，否则不能做。
3. 当检验的数据是非平稳(即存在单位根)，并且各个序列是同阶单整(协整检验的前提)，想进一步确定变量之间是否存在协整关系，可以进行协整检验，协整检验主要有EG两步法和JJ检验。
    - EG两步法是基于回归**残差**的检验，可以通过建立OLS模型检验其残差平稳性；
    - JJ检验是基于回归**系数**的检验，前提是建立VAR模型(即模型符合ADL模式)。
4. **未理解**：当变量之间存在协整关系时，可以建立ECM进一步考察短期关系，**Eviews这里还提供了一个Wald-Granger检验，但此时的格兰杰已经不是因果关系检验，而是变量外生性检验**，请注意识别。
5. 格兰杰检验只能用于平稳序列！这是格兰杰检验的前提，而其因果关系并非我们通常理解的因与果的关系，而是说x的前期变化能有效地解释y的变化，所以称其为“格兰杰原因”。
6. **未理解**：非平稳序列很可能出现伪回归，协整的意义就是检验它们的回归方程所描述的因果关系是否是伪回归，即检验变量之间是否存在稳定的关系。所以，非平稳序列的因果关系检验就是协整检验。
7. 平稳性检验有3个作用：1)检验平稳性，若平稳，做格兰杰检验，非平稳，作协正检验。2)协整检验中要用到每个序列的单整阶数。3)判断时间序列的数据生成过程。

    > ADF检验：1). view---unit root test,出现对话框，默认的选项为变量的原阶序列检验平稳性，确认后，若ADF检验的P值小于0.05，拒绝原假设，说明序列是平稳的，若P值大于0.5，接受原假设，说明序列是非平稳的；2). 重复刚才的步骤，view---unit root test,出现对话框，选择1st difference,即对变量的一阶差分序列做平稳性检验，和第一步中的检验标准相同，若P值小于5%，说明是一阶平稳，若P值大于5%，则继续进行二阶差分序列的平稳性检验。 

    > 先做单位根检验，看变量序列是否平稳序列，若平稳，可构造回归模型等经典计量经济学模型；若非平稳，进行差分，当进行到第i次差分时序列平稳，则服从i阶单整(注意趋势、截距不同情况选择，根据P值和原假设判定)。若所有检验序列均服从同阶单整，可构造VAR模型，做协整检验(注意滞后期的选择)，判断模型内部变量间是否存在协整关系，即是否存在长期均衡关系。如果有，则可以构造VEC模型或者进行Granger因果检验，检验变量之间“谁引起谁变化”，即因果关系。 

    > - 第一，格兰杰因果检验是检验统计上的时间先后顺序，并不表示而这真正存在因果关系，是否呈因果关系需要根据理论、经验和模型来判定。 
    > - 第二，格兰杰因果检验的变量应是平稳的，如果单位根检验发现两个变量是不稳定的，那么，不能直接进行格兰杰因果检验，所以，很多人对不平稳的变量进行格兰杰因果检验，这是错误的。 
    > - 第三，协整结果仅表示变量间存在长期均衡关系，那么，到底是先做格兰杰还是先做协整呢？因为变量不平稳才需要协整，所以，首先因对变量进行差分，平稳后，可以用差分项进行格兰杰因果检验，来判定变量变化的先后时序，之后，进行协整，看变量是否存在长期均衡。 
    > - 第四，长期均衡并不意味着分析的结束，还应考虑短期波动，要做误差修正检验。

8. 单位根检验是检验数据的平稳性，或是说单整阶数。
9. 协整是说两个或多个变量之间具有长期的稳定关系。但变量间协整的必要条件是它们之间是同阶单整，也就是说在进行协整检验之前必须进行单位跟检验。
10. 协整说的是变量之间存在长期的稳定关系，这只是从数量上得到的结论，但不能确定谁是因，谁是果。而因果关系检验解决的就是这个问题。

    > 单位根检验是检验时间序列是否平稳，协整是在时间序列平稳性的基础上做长期趋势的分析，而格兰杰检验一般是在建立误差修正模型的后，所建立的短期的因果关系。故顺序自然是先做单位根检验，再过协整检验，最后是格兰杰因果检验。 

    > 单位根检验是对时间序列平稳性的检验，只有平稳的时间序列，才能进行计量分析，否则会出现伪回归现象；协整是考察两个或者多个变量之间的长期平稳关系，考察两者的协整检验通常采用恩格尔-格兰杰检验，两者以上则用Johansen检验；格兰杰因果检验是考察变量之间的因果关系，协整说明长期稳定关系不一定是因果关系，所以需要在通过格兰杰因果检验确定两者的因果关系。顺序一般是单位根检验，通过后如果同阶单整，在进行协整，然后在进行因果检验。要特别注意的是：只有同阶单整才能进行协整。

11. VAR建模时lag intervals for endogenous要填滞后期，但是此时你并不能判断哪个滞后时最优的，因此要试，选择不同的滞后期，至AIC或SC最小时，所对应着的滞后为最优滞后，此时做出来的VAR模型才较为可靠。
12. 做协整检验前作VAR的原因是，协整检验是对滞后期和检验形式非常敏感的检验，首先需要确定最优滞后。由于VAR是无约束的，而协整是有约束的，因此协整检验的最优滞后一般为VAR的最优滞后减去1，确定了最优滞后后，再去诊断检验形式，最终才能做协整。
13. 当确定了协整的个数后，往下看，有个标准化的结果，这个结果就是协整方程，由于在结果中各变量均在方程一侧，因此如果系数为正，则说明是负向关系，反之亦然。
14. 协整表示变量间的长期均衡关系，貌似与你的OLS不矛盾。

    > (1) 如检验不协整，说明没长期稳定关第，可以做VAR模型，但是模型建立后要做： 

    > - 稳定性分析：做AR根的图表分析，如所有单位根小于1，说明VAR模型定，满足脉冲分析及方差分解所需条件之一 
    > - 模型的因果关系检验：不过注意在做因果检验前要先确定滞后长度，方法见高铁梅《计量分析方法与建模》第2版P302，只有满足因果关系，加上满足条件一：稳定性，则可进行脉冲及方差分解；**如不满足因果关系，则所有不满足因果关系的变量将视为外生变量，至此要重新构建VAR模型，新的VAR模型将要引入外生变量的VAR模型**。

    > (2) VAR与VEC关系是：VEC是有协整约束(即有长期稳定关系)的VAR模型，多用于具有协整关系的非平稳时间序列建模 高铁梅 计理分析方法与建模 第2版 P295

15．简单说VAR模型建立时

- 第一步：不问序列如何均可建立初步的VAR模型(建立过程中数据可能前平稳序列，也可能是部分平稳，还可能是没协整关系的同阶不平稳序列，也可能是不同阶的不平稳序列，滞后阶数任意指定。所有序列一般视为内生向量)，
- 第二步：在建立的初步VAR后进行

    - 滞后阶数检验，以确定最终模型的滞后阶数
    - 在滞后阶数确定后进行因果关系检验，以确定哪些序列为外生变量，至此重新构建VAR模型(此时滞后阶数已定，内外生变量已定)，再进行AR根图表分析，
        - 如单位根均小于1，VAR构建完成可进行脉冲及方差分解
        - 如单位根有大于1的，考虑对原始序进行降阶处理(一阶单整序列处理方法：差分或取对数，二阶单整序列：理论上可以差分与取对数同时进行，但由于序列失去了经济含义，应放弃此处理，可考虑序列的趋势分解，如分解后仍然不能满足要求，可以罢工，不建立任何模型，休息或是打砸了电脑)，处理过后对新的序列(包括最初的哪些平稳序列)不断重复第一步与第二步，直至满足稳定性为止
- 第三步，**未理解**，建立最终的VAR后，可考虑SVAR模型，如果变量不仅存在滞后影响，还存在同期影响关系，则建立VAR模型不太合适，这种情况下需要进行结构分析。 